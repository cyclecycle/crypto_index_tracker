vars:
  $sma_1_len: 10
  $sma_2_len: 45
  $sma_1_gradient_len: 10
  $sma_2_gradient_len: 45
  $sma_1_buy_gradient: 4
  $sma_2_buy_gradient: 4
  $sma_1_sell_gradient: -4
  $sma_2_sell_gradient: -4

observables:
  sma_1:
    func: sma
    args: [price, $sma_1_len]
  sma_2:
    func: sma
    args: [price, $sma_2_len]
  sma_1_gradient:
    func: gradient
    args: [sma_1, $sma_1_gradient_len]
  sma_2_gradient:
    func: gradient
    args: [sma_2, $sma_2_gradient_len]

actions:
  buy:
    func: buy
    kwargs:
      with_funds_frac: 0.1
  sell:
    func: trade
    args: [sell]

rules:
  - action: buy
    conditions:
    - observable: sma_1_gradient
      value: ['>=', $sma_1_buy_gradient]
    - observable: sma_2_gradient
      value: ['>=', $sma_2_buy_gradient]
    - observable: n_positions
      value: ['<', 1]

  - action: sell
    conditions:
    - observable: n_positions
      value: ['>=', 1]
    - observable: sma_1_gradient
      value: ['<', $sma_1_sell_gradient]
    - observable: sma_2_gradient
      value: ['<', $sma_1_sell_gradient]
